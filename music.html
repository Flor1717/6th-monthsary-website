<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Music</title>
</head>
<body>
  <audio id="bg-music" loop>
    <source src="valentines_day.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
  </audio>

  <script>
    const music = document.getElementById("bg-music");

    // Resume from last time
    const savedTime = localStorage.getItem("musicTime");
    if (savedTime) {
      music.currentTime = parseFloat(savedTime);
    }

    // Try autoplay, fallback on click
    const tryPlay = () => {
      music.play().then(() => {
        console.log("Music playing");
      }).catch(() => {
        document.body.addEventListener("click", () => {
          music.play();
        }, { once: true });
        console.log("Autoplay blocked, will play on click.");
      });
    };

    window.addEventListener("load", tryPlay);
    window.addEventListener("beforeunload", () => {
      localStorage.setItem("musicTime", music.currentTime);
    });
  </script>
</body>
</html>
